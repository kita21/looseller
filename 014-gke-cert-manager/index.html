<!doctype html><html lang=ja><head><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[cert-manager] kubernetesをhttps化させる","datePublished":"2023-03-26T00:00:00Z","dateModified":"2023-03-26T00:00:00Z","author":{"@type":"Person","name":"kita21","image":"https://ki-ta.blog/images/avatar.png"},"mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ki-ta.blog\/014-gke-cert-manager\/"},"publisher":{"@type":"Organization","name":"ゆるだら ブログ","logo":{"@type":"ImageObject","url":"https://ki-ta.blog/images/avatar.png"}},"description":"GCPのGKE上にのを利用してElastic Cloud on Kubernetes(ECK)を利用してElasticsearchを作成する","keywords":[]}</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.111.3 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="kita21"><meta name=keywords content><meta name=description content="make kubernetes https with cert-manager"><meta property="og:description" content="make kubernetes https with cert-manager"><meta property="og:type" content="article"><meta property="og:title" content="[cert-manager] kubernetesをhttps化させる"><meta name=twitter:title content="[cert-manager] kubernetesをhttps化させる"><meta property="og:url" content="https://ki-ta.blog/014-gke-cert-manager/"><meta property="twitter:url" content="https://ki-ta.blog/014-gke-cert-manager/"><meta property="og:site_name" content="ゆるだら ブログ"><meta property="og:description" content="make kubernetes https with cert-manager"><meta name=twitter:description content="make kubernetes https with cert-manager"><meta property="og:locale" content="ja"><meta property="article:published_time" content="2023-03-26T00:00:00"><meta property="article:modified_time" content="2023-03-26T00:00:00"><meta property="article:tag" content="kubernetes"><meta name=twitter:card content="summary"><meta property="og:image" content="https://ki-ta.blog/images/avatar.png"><meta property="twitter:image" content="https://ki-ta.blog/images/avatar.png"><title>[cert-manager] kubernetesをhttps化させる</title><link rel=icon href=https://ki-ta.blog/images/avatar.png><link rel=canonical href=https://ki-ta.blog/014-gke-cert-manager/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://ki-ta.blog/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-VHM9P1Z719"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VHM9P1Z719",{anonymize_ip:!1})}</script></head><body><div id=blog><header id=header data-behavior=1><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=https://ki-ta.blog/ aria-label=ホームページへ>ゆるだら ブログ</a></div></header><nav id=sidebar data-behavior=1><div class=sidebar-container><div class=sidebar-profile><a href=https://ki-ta.blog/#about aria-label=著者についてもっと読む><img class=sidebar-profile-picture src=https://ki-ta.blog/images/avatar.png alt=プロフィール画像></a><h4 class=sidebar-profile-name>kita21</h4><h5 class=sidebar-profile-bio><strong>no rest no life</strong></h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://ki-ta.blog/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>ホーム</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://ki-ta.blog/categories title=Categories><i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden=true></i>
<span class=sidebar-button-desc>カテゴリー</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://ki-ta.blog/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>タグ</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://ki-ta.blog/archives title=Archives><i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden=true></i>
<span class=sidebar-button-desc>アーカイブ</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/kita21 target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href="https://www.facebook.com/profile.php?id=100035276171326" target=_blank rel=noopener title=Facebook><i class="sidebar-button-icon fab fa-lg fa-facebook" aria-hidden=true></i>
<span class=sidebar-button-desc>Facebook</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://ki-ta.blog/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div></nav><div id=main data-behavior=1 class=hasCoverMetaIn><article class=post id=top><div class="post-header main-content-wrap text-left"><h1 class=post-title>[cert-manager] kubernetesをhttps化させる</h1><div class="postShorten-meta post-meta"><time datetime=2023-03-26T00:00:00Z>3月 26, 2023</time></div></div><div class="post-content markdown"><div class=main-content-wrap><h1 id=table-of-contents>目次</h1><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#今回作成するもの>今回作成するもの</a></li><li><a href=#環境>環境</a></li><li><a href=#前提>前提</a></li><li><a href=#handson>handsOn</a><ul><li><a href=#ドメイン登録をする>ドメイン登録をする</a></li><li><a href=#cert-managerのinstall>cert-managerのInstall</a></li><li><a href=#検証に使用するsecret作成>検証に使用するSecret作成</a></li><li><a href=#issuer>Issuer</a></li><li><a href=#certificate>Certificate</a></li><li><a href=#loadbalancerをtls化させる>LoadBalancerをtls化させる</a></li></ul></li><li><a href=#はまった時のデバッグ方法>はまった時のデバッグ方法</a><ul><li><a href=#cert-managerのpodのログを確認する>cert-managerのpodのログを確認する</a></li><li><a href=#certificaterequest-order-challengeを確認する>CertificateRequest, Order, Challengeを確認する</a></li></ul></li><li><a href=#終わりに>終わりに</a></li><li><a href=#参考>参考</a></li></ul></nav><h1 id=introduction>Introduction</h1><p>前回の記事(<a href=https://ki-ta.blog/013-gke-eck/>[kubernetes] GKEにElasticsearch環境を構築する</a>)で、GKE上にElasticsearchを構築しました。しかしElasticsearchをただ構築しただけなのでElasticsearchにアクセスするためにはipを直指定しなければいけない状態になっています。<br>流石にipを指定してやり取りするのは不便すぎるのでドメインを登録して疎通するようにしたいと思います。また今回のメインであるhttps化することによって安全にアクセスできるようにしたいと思います。
cert-managerに出てくるリソースの役割などの詳しい説明は、<a href=https://zenn.dev/masaaania/articles/e54119948bbaa2>cert-manager基礎知識</a>や<a href=https://blog.manabusakai.com/2021/10/custom-resources-for-cert-manager/>cert-manager のカスタムリソースの関連性について調べてみた</a>をご覧ください。とてもわかりやすく解説されています。もちろん公式をしっかり読むでもいいでしょう。</p><h1 id=今回作成するもの>今回作成するもの</h1><ul><li>route53でのドメイン登録</li><li>cert-managerでの証明書自動更新システム構築</li></ul><p>完成系</p><ul><li><a href=https://github.com/kita21/tech-blog-sample/tree/main/014-gke-cert-manager>https://github.com/kita21/tech-blog-sample/tree/main/014-gke-cert-manager</a></li></ul><h1 id=環境>環境</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>前回の環境が整っている
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cert-manager: v1.11.0
</span></span></code></pre></div><h1 id=前提>前提</h1><ul><li>AWSアカウントを登録している</li><li>Elasticsearchに登録するドメインを取得している</li><li>前回の環境が整っている</li></ul><h1 id=handson>handsOn</h1><h2 id=ドメイン登録をする>ドメイン登録をする</h2><p>今回は、AWSのRoute53でドメイン登録をした場合のcert-manager構築になります。<br>では、まずRoute53にドメインを登録します。ここは特に説明することがないので省きます。また今回のドメインは<code>es.ki-ta.blog</code>とサブドメインで登録します。<br>前回作成したLoadBalancerの外部IPは、<code>34.146.210.75</code>でしたね。<br>Route53に登録したらドメインのIPがあっているか確認してください。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ dig es.ki-ta.blog +short
</span></span><span style=display:flex><span>34.146.210.75
</span></span></code></pre></div><p>これでドメイン登録は完了しました。
<code>http://es.ki-ta.blog:9200</code>で叩くとElasticsearchにアクセスできるはずです。</p><h2 id=cert-managerのinstall>cert-managerのInstall</h2><p>次に登録したドメインに安全にアクセスできるようにhttps化していきたいと思います。<br>cert-managerをInstallします。<br>versionは1.11.0を指定します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.11.0/cert-manager.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ kubectl get pods -n cert-manager
</span></span><span style=display:flex><span>cert-manager-6dd9658548-h6g2k              1/1     Running   <span style=color:#ae81ff>0</span>          51s
</span></span><span style=display:flex><span>cert-manager-cainjector-5987875fc7-clx8d   1/1     Running   <span style=color:#ae81ff>0</span>          51s
</span></span><span style=display:flex><span>cert-manager-webhook-7b4c5f579b-wsgsp      1/1     Running   <span style=color:#ae81ff>0</span>          51s
</span></span></code></pre></div><p>cert-managerのpodが立っているのが確認できればOKです。</p><h2 id=検証に使用するsecret作成>検証に使用するSecret作成</h2><p>まず、GKE上のcert-managerとAWSのRoute53が疎通できるように認証情報を作成していきます。<br>AWSのIAMアクセスキーの発行の仕方は、今回詳しく説明しません。多くの記事や<a href=https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_credentials_access-keys.html>公式</a>で説明されているので調べながら発行してください。<br>cert-managerの公式から持ってきた以下の認証情報でIAMユーザーを作成し、アクセスキーを発行します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Version&#34;</span>: <span style=color:#e6db74>&#34;2012-10-17&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Statement&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: <span style=color:#e6db74>&#34;route53:GetChange&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:route53:::change/*&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;route53:ChangeResourceRecordSets&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;route53:ListResourceRecordSets&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:route53:::hostedzone/*&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: <span style=color:#e6db74>&#34;route53:ListHostedZonesByName&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;*&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>発行したらダウンロードしアクセスキーとシークレットキーでkubernetesのSecretを作成します</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>k8s
</span></span><span style=display:flex><span> L cert-manager
</span></span><span style=display:flex><span>  L secret.yaml(new)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Secret</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>route53-credentials-secret</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>cert-manager</span>
</span></span><span style=display:flex><span><span style=color:#f92672>stringData</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>access-key</span>: <span style=color:#ae81ff>AKIAXXXXXXXXXXXXXXXX</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>secret-key</span>: <span style=color:#ae81ff>xxxxxxxxxxxxxxxxxxxxxxxxx</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl apply -f k8s/cert-manager/secret.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ kubectl get secret -n cert-manager
</span></span><span style=display:flex><span>NAME                       TYPE     DATA   AGE
</span></span><span style=display:flex><span>route53-credentials-secret Opaque   <span style=color:#ae81ff>2</span>      4s
</span></span></code></pre></div><p>注意事項としては、後ほどClusterIssuerでChallengeをする際、作成したSecretを参照するのですが、namespaceをcert-managerと同じにしないと<code>error getting route53 secret access key: secret "route53-credentials-secret" not found</code>というエラーでSecretが見つからないと言われます。</p><h2 id=issuer>Issuer</h2><p>次に実際のcert-managerでのリソースを<a href=https://cert-manager.io/docs/configuration/acme/dns01/route53/>cert-manager - Route53</a>を参考にしながら実際のリソースを作成していきます。<br>まずcert-managerでIssuerからです。<br>route53でドメイン検証を行う設定を記載します。route53のプロパティの詳細は<a href=https://cert-manager.io/docs/reference/api-docs/#acme.cert-manager.io/v1.ACMEIssuerDNS01ProviderRoute53>ACMEIssuerDNS01ProviderRoute53</a>をご覧ください。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>k8s
</span></span><span style=display:flex><span> L cert-manager
</span></span><span style=display:flex><span>  L secret.yaml
</span></span><span style=display:flex><span>    issuer.yaml(new)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cert-manager.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterIssuer</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>es-sample-letsencrypt</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>acme</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span>: <span style=color:#ae81ff>https://acme-v02.api.letsencrypt.org/directory</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>email</span>: <span style=color:#ae81ff>sample@gmail.com</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>privateKeySecretRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>es-sample-letsencrypt-secret</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>solvers</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>dnsZones</span>:
</span></span><span style=display:flex><span>        - <span style=color:#e6db74>&#39;*.ki-ta.blog&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>dns01</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>route53</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>hostedZoneID</span>: <span style=color:#ae81ff>Z012345689ABCDEFG</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>accessKeyIDSecretRef</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>route53-credentials-secret</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>key</span>: <span style=color:#ae81ff>access-key</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>secretAccessKeySecretRef</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>route53-credentials-secret</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>key</span>: <span style=color:#ae81ff>secret-key</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>region</span>: <span style=color:#ae81ff>ap-northeast-1</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl apply -f k8s/cert-manager/issuer.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ kubectl get clusterissuer
</span></span><span style=display:flex><span>NAME             READY   AGE
</span></span><span style=display:flex><span>es-sample-letsencrypt   True    23s
</span></span></code></pre></div><p>今回は、namespaceを考えたくないので<code>ClusterIssuer</code>で作成します。また、route53のregionはどれでもいいと思いますが今回は<code>ap-northeast-1</code>にしておきます。
他にも注意していただきたいところは、<code>accessKeyIDSecretRef</code>を使用しているところです。2023/03現在の公式Getting Startedでは1.8.2のcert-managerを利用していますが、accessKeyIDSecretRefは1.8系ではバグがあり<a href=https://cert-manager.io/docs/release-notes/release-notes-1.9/#changes-since-v190>1.9系でまともに使用できるようになった</a>のでcert-managerのversionには注意してください。この記事ではver.1.11.0を使用しています。</p><h2 id=certificate>Certificate</h2><p>続いてCertificateを作成します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>k8s
</span></span><span style=display:flex><span> L cert-manager
</span></span><span style=display:flex><span>  L secret.yaml
</span></span><span style=display:flex><span>    issuer.yaml
</span></span><span style=display:flex><span>    cert.yaml(new)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cert-manager.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Certificate</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>es-sample-cert</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>es-sample-cert-secret</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>issuerRef</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>es-sample-letsencrypt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterIssuer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>dnsNames</span>:
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#39;*.ki-ta.blog&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl apply -f k8s/cert-manager/cert.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ kubectl get cert
</span></span><span style=display:flex><span>NAME             READY   SECRET                  AGE
</span></span><span style=display:flex><span>es-sample-cert   False   es-sample-cert-secret   2s
</span></span></code></pre></div><p>作成してすぐは、READYがFalseですが少し待つとTrueに切り替わります</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl get cert
</span></span><span style=display:flex><span>NAME             READY   SECRET                  AGE
</span></span><span style=display:flex><span>es-sample-cert   True    es-sample-cert-secret   1m
</span></span></code></pre></div><h2 id=loadbalancerをtls化させる>LoadBalancerをtls化させる</h2><p>Let&rsquo;sEncryptの証明書ができたので、それをLoadBalancerに紐づけます</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>k8s
</span></span><span style=display:flex><span> L cert-manager
</span></span><span style=display:flex><span>  L secret.yaml
</span></span><span style=display:flex><span>    issuer.yaml
</span></span><span style=display:flex><span>    cert.yaml
</span></span><span style=display:flex><span> L es.yaml(modify)
</span></span><span style=display:flex><span>   es-realm-secret.yaml
</span></span><span style=display:flex><span>   monstache.yaml
</span></span><span style=display:flex><span>   kibana.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>elasticsearch.k8s.elastic.co/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Elasticsearch</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>es-sample</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>version</span>: <span style=color:#ae81ff>8.6.2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>auth</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>fileRealm</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>es-realm-secret</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>nodeSets</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>count</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>node.store.allow_mmap</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>service</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>type</span>: <span style=color:#ae81ff>LoadBalancer</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>tls</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>certificate</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>es-sample-cert-secret</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl apply -f k8s/es.yaml
</span></span></code></pre></div><p>これでElasticsearchが再起動するのを待ちます。なかなか再起動しない場合はpodを一回削除してください</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl delete pods es-sample-es-default-0
</span></span></code></pre></div><p>これで、今回作成するリソースは全て完了です。httpsで接続できるか確認してみましょう</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ curl -u <span style=color:#e6db74>&#34;elastic:5Esma90y3459ppeh7ubsnU78&#34;</span> <span style=color:#e6db74>&#34;https://es.ki-ta.blog:9200&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;es-sample-es-default-0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;cluster_name&#34;</span> : <span style=color:#e6db74>&#34;es-sample&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;cluster_uuid&#34;</span> : <span style=color:#e6db74>&#34;YNw1s2ywRoKukHh9mWdiTA&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;version&#34;</span> : <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;number&#34;</span> : <span style=color:#e6db74>&#34;8.6.2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;build_flavor&#34;</span> : <span style=color:#e6db74>&#34;default&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;build_type&#34;</span> : <span style=color:#e6db74>&#34;docker&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;build_hash&#34;</span> : <span style=color:#e6db74>&#34;2d58d0f136141f03239816a4e360a8d17b6d8f29&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;build_date&#34;</span> : <span style=color:#e6db74>&#34;2023-02-13T09:35:20.314882762Z&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;build_snapshot&#34;</span> : false,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;lucene_version&#34;</span> : <span style=color:#e6db74>&#34;9.4.2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;minimum_wire_compatibility_version&#34;</span> : <span style=color:#e6db74>&#34;7.17.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;minimum_index_compatibility_version&#34;</span> : <span style=color:#e6db74>&#34;7.0.0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;tagline&#34;</span> : <span style=color:#e6db74>&#34;You Know, for Search&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>httpsで接続できましたね！逆にhttpでは接続できなくなっています</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ curl -u <span style=color:#e6db74>&#34;elastic:5Esma90y3459ppeh7ubsnU78&#34;</span> <span style=color:#e6db74>&#34;http://es.ki-ta.blog:9200&#34;</span>
</span></span><span style=display:flex><span>curl: <span style=color:#f92672>(</span>52<span style=color:#f92672>)</span> Empty reply from server
</span></span></code></pre></div><p>httpで接続できなくなったので、monstacheもhttpsでの接続に変更しておきましょう</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>k8s
</span></span><span style=display:flex><span> L cert-manager
</span></span><span style=display:flex><span>  L secret.yaml
</span></span><span style=display:flex><span>    issuer.yaml
</span></span><span style=display:flex><span>    cert.yaml
</span></span><span style=display:flex><span> L es.yaml
</span></span><span style=display:flex><span>   es-realm-secret.yaml
</span></span><span style=display:flex><span>   monstache.yaml(modify)
</span></span><span style=display:flex><span>   kibana.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># ConfigMapのみ変更</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ConfigMap</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>monstache-config</span>
</span></span><span style=display:flex><span><span style=color:#f92672>data</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>elasticsearch-url</span>: <span style=color:#ae81ff>https://es.ki-ta.blog:9200</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl apply -f k8s/monstache.yaml
</span></span></code></pre></div><h1 id=はまった時のデバッグ方法>はまった時のデバッグ方法</h1><p>今回のcert-managerの構築で一番はまってしまうポイントがCertificateを作成してREADYがTrueにならずFalseのままになってしまうことではないでしょうか？
考えられるミスとして</p><ol><li>ClusterIssuerで作成しているのにCertificateのissuerRefがIssuerを指定してしまっている</li><li>ClusterIssuerで参照するSecretのnamespaceの格納場所が違う</li><li>Route53のアクセスキーのIAMの権限が不足している</li></ol><p>などが挙げられますが、作成したClusterIssuerやCertificateを見てもあまり解決にはつながりません。<br>そのためデバッグ方法は主に以下の2種類があげられます</p><ul><li>cert-managerのpodのログを確認する</li><li>CertificateRequest, Order, Challengeを確認する</li></ul><p>例として、ClusterIssuerが参照するSecretのnamespaceが違う場合を想定します。<br>CertificateのReadyがFalseのままです</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl get cert
</span></span><span style=display:flex><span>NAME             READY   SECRET                  AGE
</span></span><span style=display:flex><span>es-sample-cert   False   es-sample-cert-secret   9s
</span></span></code></pre></div><h2 id=cert-managerのpodのログを確認する>cert-managerのpodのログを確認する</h2><p>こちらは単純にcert-manager自体にエラーが記録されているのでログを確認します</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl get pods -n cert-manager
</span></span><span style=display:flex><span>cert-manager-6dd9658548-h6g2k              1/1     Running   <span style=color:#ae81ff>0</span>          1h
</span></span><span style=display:flex><span>cert-manager-cainjector-5987875fc7-clx8d   1/1     Running   <span style=color:#ae81ff>0</span>          1h
</span></span><span style=display:flex><span>cert-manager-webhook-7b4c5f579b-wsgsp      1/1     Running   <span style=color:#ae81ff>0</span>          1h
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ kubectl logs cert-manager-6dd9658548-h6g2k -n cert-manager
</span></span><span style=display:flex><span>E0325 12:10:38.277375       <span style=color:#ae81ff>1</span> controller.go:167<span style=color:#f92672>]</span> cert-manager/challenges <span style=color:#e6db74>&#34;msg&#34;</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;re-queuing item due to error processing&#34;</span> <span style=color:#e6db74>&#34;error&#34;</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;error getting route53 secret access key id: secret \&#34;route53-credentials-secret\&#34; not found&#34;</span> <span style=color:#e6db74>&#34;key&#34;</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;default/es-sample-cert-8p8pn-3897637060-3630231849&#34;</span>
</span></span></code></pre></div><p>Secretのroute53-credentials-secretが見つからないというエラーが出ていることがわかりますね</p><h2 id=certificaterequest-order-challengeを確認する>CertificateRequest, Order, Challengeを確認する</h2><p>ドメイン検証のためのチャレンジを行うため、Certificateを作成するとCertificateRequest → Order → Challengeの順に作成されていきます。リソースの詳細は最初に記載した記事をご覧ください。
そのためいずれかのリソースでエラーが出ている可能性があるため、確認しエラーを起こしているリソースの詳細を見てみましょう。</p><pre tabindex=0><code>$ kubectl get certificaterequest,order,challenge
NAME                                                      APPROVED   DENIED   READY   ISSUER                  REQUESTOR                                         AGE
certificaterequest.cert-manager.io/es-sample-cert-8p8pn   True                False   es-sample-letsencrypt   system:serviceaccount:cert-manager:cert-manager   5m37s

NAME                                                         STATE     AGE
order.acme.cert-manager.io/es-sample-cert-8p8pn-3897637060   pending   5m37s

NAME                                                                        STATE     DOMAIN                   AGE
challenge.acme.cert-manager.io/es-sample-cert-8p8pn-3897637060-3630231849   pending   development-mood.space   5m35s
</code></pre><p>Orderとchallengeがpendingになってますね
Orderを見てみましょう</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ describe order es-sample-cert-8p8pn-3897637060
</span></span><span style=display:flex><span>Events:
</span></span><span style=display:flex><span>  Type    Reason   Age   From                 Message
</span></span><span style=display:flex><span>  ----    ------   ----  ----                 -------
</span></span><span style=display:flex><span>  Normal  Created  7m1s  cert-manager-orders  Created Challenge resource <span style=color:#e6db74>&#34;es-sample-cert-8p8pn-3897637060-3630231849&#34;</span> <span style=color:#66d9ef>for</span> domain <span style=color:#e6db74>&#34;ki-ta.blog&#34;</span>
</span></span></code></pre></div><p>Orderではエラーが出ていないですね。次にChallengeを見てみましょう</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ kubectl describe challenge es-sample-cert-8p8pn-3897637060-3630231849
</span></span><span style=display:flex><span>Events:
</span></span><span style=display:flex><span>  Type     Reason        Age                    From                     Message
</span></span><span style=display:flex><span>  ----     ------        ----                   ----                     -------
</span></span><span style=display:flex><span>  Normal   Started       7m33s                  cert-manager-challenges  Challenge scheduled <span style=color:#66d9ef>for</span> processing
</span></span><span style=display:flex><span>  Warning  PresentError  2m27s <span style=color:#f92672>(</span>x7 over 7m32s<span style=color:#f92672>)</span>  cert-manager-challenges  Error presenting challenge: error getting route53 secret access key id: secret <span style=color:#e6db74>&#34;route53-credentials-secret&#34;</span> not found
</span></span></code></pre></div><p>Warningでcert-managerのログと同じ<code>"route53-credentials-secret" not found</code>が出ていることが確認できました。</p><h1 id=終わりに>終わりに</h1><p>cert-managerでkubernetesのリソースをhttps化する方法を解説しました。cert-managerは出てくるリソースが多く最初は理解しづらいかもしれませんが、一回全てを通してhttps化させるとなんとなく概要がわかってくるので根気強く勉強してみてください。</p><h1 id=参考>参考</h1><ul><li><a href=https://cert-manager.io/docs>cert-manager公式 / Docs</a></li><li><a href=https://zenn.dev/masaaania/articles/e54119948bbaa2>cert-manager基礎知識</a></li><li><a href=https://blog.manabusakai.com/2021/10/custom-resources-for-cert-manager/>cert-manager のカスタムリソースの関連性について調べてみた</a></li></ul></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">タグ</span><br><a class="tag tag--primary tag--small" href=https://ki-ta.blog/tags/kubernetes/>kubernetes</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--disabled"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">次</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://ki-ta.blog/013-gke-eck/ data-tooltip="[kubernetes] GKEにElasticsearch環境を構築する" aria-label="前: [kubernetes] GKEにElasticsearch環境を構築する"><span class="hide-xs hide-sm text-small icon-mr">前</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label=この記事を共有する><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label=トップに戻る><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2023 <a href=https://github.com/kita21>kita21</a>. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=1><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--disabled"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">次</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://ki-ta.blog/013-gke-eck/ data-tooltip="[kubernetes] GKEにElasticsearch環境を構築する" aria-label="前: [kubernetes] GKEにElasticsearch環境を構築する"><span class="hide-xs hide-sm text-small icon-mr">前</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label=この記事を共有する><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label=トップに戻る><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://ki-ta.blog/images/avatar.png alt=プロフィール画像><h4 id=about-card-name>kita21</h4><div id=about-card-bio><strong>no rest no life</strong></div><div id=about-card-job><i class="fa fa-briefcase"></i><br>web engineer</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Japan</div></div></div><div id=cover style=background-image:url(https://ki-ta.blog/images/cover.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://ki-ta.blog/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js></script>
<script async crossorigin=anonymous defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js></script>
<script async crossorigin=anonymous defer fbadminids=100035276171326 integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js></script>
<script>$(document).ready(function(){hljs.configure({classPrefix:"",useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(e,t){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(t)})})</script></body></html>